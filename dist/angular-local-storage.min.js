/**
 * An Angular module that gives you access to the browsers local storage
 * @version v0.7.1 - 2017-12-12
 * @link https://github.com/grevory/angular-local-storage
 * @author grevory <greg@gregpike.ca>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(e,t){var o=t.isDefined,r=t.isUndefined,n=t.isNumber,i=t.isObject,a=t.isArray,s=t.isString,c=t.extend,u=t.toJson;t.module("LocalStorageModule",[]).provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/",secure:!1},this.defaultToCookie=!0,this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(e){return this.prefix=e,this},this.setStorageType=function(e){return this.storageType=e,this},this.setDefaultToCookie=function(e){return this.defaultToCookie=!!e,this},this.setStorageCookie=function(e,t,o){return this.cookie.expiry=e,this.cookie.path=t,this.cookie.secure=o,this},this.setStorageCookieDomain=function(e){return this.cookie.domain=e,this},this.setNotify=function(e,t){return this.notify={setItem:e,removeItem:t},this},this.$get=["$rootScope","$window","$document","$parse",function(e,t,l,f){function g(o){if(o||(o=t.event),p.setItem&&s(o.key)&&k(o.key)){var r=S(o.key);e.$broadcast("LocalStorageModule.notification.changed",{key:r,newvalue:o.newValue,storageType:h.storageType})}}var d,h=this,y=h.prefix,T=h.cookie,p=h.notify,v=h.storageType;l?l[0]&&(l=l[0]):l=document,"."!==y.substr(-1)&&(y=y?y+".":"");var m=function(e){return y+e},S=function(e){return e.replace(new RegExp("^"+y,"g"),"")},k=function(e){return 0===e.indexOf(y)},O=function(){try{var o=v in t&&null!==t[v],r=m("__"+Math.round(1e7*Math.random()));return o&&((d=t[v]).setItem(r,""),d.removeItem(r)),o}catch(t){return h.defaultToCookie&&(v="cookie"),e.$broadcast("LocalStorageModule.notification.error",t.message),!1}},b=O(),L=function(t,o,n){var i=R();try{if(I(n),o=r(o)?null:u(o),!b&&h.defaultToCookie||"cookie"===h.storageType)return b||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:o,storageType:"cookie"}),x(t,o);try{d&&d.setItem(m(t),o),p.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:o,storageType:h.storageType})}catch(r){return e.$broadcast("LocalStorageModule.notification.error",r.message),x(t,o)}return!0}finally{I(i)}},$=function(t,o){var r=R();try{if(I(o),!b&&h.defaultToCookie||"cookie"===h.storageType)return b||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),w(t);var n=d?d.getItem(m(t)):null;if(!n||"null"===n)return null;try{return JSON.parse(n)}catch(e){return n}}finally{I(r)}},E=function(){var t=R();try{var o=0;arguments.length>=1&&("localStorage"===arguments[arguments.length-1]||"sessionStorage"===arguments[arguments.length-1])&&(o=1,I(arguments[arguments.length-1]));var r,n;for(r=0;r<arguments.length-o;r++)if(n=arguments[r],!b&&h.defaultToCookie||"cookie"===h.storageType)b||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:n,storageType:"cookie"}),C(n);else try{d.removeItem(m(n)),p.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:n,storageType:h.storageType})}catch(t){e.$broadcast("LocalStorageModule.notification.error",t.message),C(n)}}finally{I(t)}},M=function(){try{return t.navigator.cookieEnabled||"cookie"in l&&(l.cookie.length>0||(l.cookie="test").indexOf.call(l.cookie,"test")>-1)}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),!1}}(),x=function(t,o,s,c){if(r(o))return!1;if((a(o)||i(o))&&(o=u(o)),!M)return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var f="",g=new Date,d="";if(null===o?(g.setTime(g.getTime()+-864e5),f="; expires="+g.toGMTString(),o=""):n(s)&&0!==s?(g.setTime(g.getTime()+24*s*60*60*1e3),f="; expires="+g.toGMTString()):0!==T.expiry&&(g.setTime(g.getTime()+24*T.expiry*60*60*1e3),f="; expires="+g.toGMTString()),t){var h="; path="+T.path;T.domain&&(d="; domain="+T.domain),"boolean"==typeof c?!0===c&&(d+="; secure"):!0===T.secure&&(d+="; secure"),l.cookie=m(t)+"="+encodeURIComponent(o)+f+h+d}}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),!1}return!0},w=function(t){if(!M)return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var o=l.cookie&&l.cookie.split(";")||[],r=0;r<o.length;r++){for(var n=o[r];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(m(t)+"=")){var i=decodeURIComponent(n.substring(y.length+t.length+1,n.length));try{var a=JSON.parse(i);return"number"==typeof a?i:a}catch(e){return i}}}return null},C=function(e){x(e,null)},_=function(){for(var e=null,t=y.length,o=l.cookie.split(";"),r=0;r<o.length;r++){for(e=o[r];" "===e.charAt(0);)e=e.substring(1,e.length);var n=e.substring(t,e.indexOf("="));C(n)}},R=function(){return v},I=function(e){return e&&v!==e&&(v=e,b=O()),b};b&&(t.addEventListener?(t.addEventListener("storage",g,!1),e.$on("$destroy",function(){t.removeEventListener("storage",g)})):t.attachEvent&&(t.attachEvent("onstorage",g),e.$on("$destroy",function(){t.detachEvent("onstorage",g)})));return{isSupported:b,getStorageType:R,setStorageType:I,setPrefix:function(e){y=e},set:L,add:L,get:$,keys:function(t){var o=R();try{if(I(t),!b)return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),[];var r=y.length,n=[];for(var i in d)if(i.substr(0,r)===y)try{n.push(i.substr(r))}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.Description),[]}return n}finally{I(o)}},remove:E,clearAll:function(t,o){var r=R();try{I(o);var n=y?new RegExp("^"+y):new RegExp,i=t?new RegExp(t):new RegExp;if(!b&&h.defaultToCookie||"cookie"===h.storageType)return b||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),_();if(!b&&!h.defaultToCookie)return!1;var a=y.length;for(var s in d)if(n.test(s)&&i.test(s.substr(a)))try{E(s.substr(a))}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),_()}return!0}finally{I(r)}},bind:function(e,t,r,n,a){var s=$(n=n||t,a);return null===s&&o(r)?s=r:i(s)&&i(r)&&(s=c(s,r)),f(t).assign(e,s),e.$watch(t,function(e){L(n,e,a)},i(e[t]))},deriveKey:m,underiveKey:S,length:function(e){var o=R();try{I(e);for(var r=0,n=t[v],i=0;i<n.length;i++)0===n.key(i).indexOf(y)&&r++;return r}finally{I(o)}},defaultToCookie:this.defaultToCookie,cookie:{isSupported:M,set:x,add:x,get:w,remove:C,clearAll:_}}}]})}(window,window.angular);
//# sourceMappingURL=angular-local-storage.min.js.map